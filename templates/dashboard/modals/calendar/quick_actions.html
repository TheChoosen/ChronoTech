<!-- Actions Rapides du Calendrier -->
<div class="calendar-quick-actions">
    <h6 class="mb-3">
        <i class="fa-solid fa-bolt me-2"></i>
        Actions Rapides
    </h6>
    
    <div class="row g-2">
        <!-- Nouvelle Intervention -->
        <div class="col-6">
            <button class="btn btn-primary btn-sm w-100" onclick="createNewIntervention()">
                <i class="fa-solid fa-plus me-1"></i>
                Intervention
            </button>
        </div>
        
        <!-- Planning Technicien -->
        <div class="col-6">
            <button class="btn btn-success btn-sm w-100" onclick="assignTechnician()">
                <i class="fa-solid fa-user-plus me-1"></i>
                Assigner
            </button>
        </div>
        
        <!-- Maintenance Préventive -->
        <div class="col-6">
            <button class="btn btn-info btn-sm w-100" onclick="schedulePreventiveMaintenance()">
                <i class="fa-solid fa-calendar-check me-1"></i>
                Préventif
            </button>
        </div>
        
        <!-- Rapport Express -->
        <div class="col-6">
            <button class="btn btn-warning btn-sm w-100" onclick="generateQuickReport()">
                <i class="fa-solid fa-chart-line me-1"></i>
                Rapport
            </button>
        </div>
    </div>
    
    <!-- Raccourcis Planning -->
    <div class="mt-3">
        <h6 class="mb-2">
            <i class="fa-solid fa-clock me-2"></i>
            Vues Rapides
        </h6>
        <div class="btn-group w-100" role="group">
            <button type="button" class="btn btn-outline-secondary btn-sm" onclick="switchCalendarView('day')">
                Jour
            </button>
            <button type="button" class="btn btn-outline-secondary btn-sm" onclick="switchCalendarView('week')">
                Semaine
            </button>
            <button type="button" class="btn btn-outline-secondary btn-sm" onclick="switchCalendarView('month')">
                Mois
            </button>
        </div>
    </div>
    
    <!-- Filtres Rapides -->
    <div class="mt-3">
        <h6 class="mb-2">
            <i class="fa-solid fa-filter me-2"></i>
            Filtres
        </h6>
        <div class="form-check form-check-sm">
            <input class="form-check-input" type="checkbox" id="filterUrgent" checked onchange="toggleEventFilter('urgent')">
            <label class="form-check-label small" for="filterUrgent">
                Urgentes
            </label>
        </div>
        <div class="form-check form-check-sm">
            <input class="form-check-input" type="checkbox" id="filterMaintenance" checked onchange="toggleEventFilter('maintenance')">
            <label class="form-check-label small" for="filterMaintenance">
                Maintenance
            </label>
        </div>
        <div class="form-check form-check-sm">
            <input class="form-check-input" type="checkbox" id="filterMeeting" checked onchange="toggleEventFilter('meeting')">
            <label class="form-check-label small" for="filterMeeting">
                Réunions
            </label>
        </div>
    </div>
</div>

<script>
function createNewIntervention() {
    // Créer une nouvelle intervention avec la date sélectionnée
    const selectedDate = window.calendar?.getDate() || new Date();
    const url = `/work_orders/create?date=${selectedDate.toISOString().split('T')[0]}`;
    window.location.href = url;
}

function assignTechnician() {
    // Ouvrir la modal d'assignation de technicien
    const modal = document.getElementById('assignTechnicianModal');
    if (modal) {
        new bootstrap.Modal(modal).show();
    }
}

function schedulePreventiveMaintenance() {
    // Programmer une maintenance préventive
    const selectedDate = window.calendar?.getDate() || new Date();
    const url = `/maintenance/schedule?type=preventive&date=${selectedDate.toISOString().split('T')[0]}`;
    window.location.href = url;
}

function generateQuickReport() {
    // Générer un rapport rapide pour la période sélectionnée
    const selectedDate = window.calendar?.getDate() || new Date();
    const startDate = new Date(selectedDate.getFullYear(), selectedDate.getMonth(), 1);
    const endDate = new Date(selectedDate.getFullYear(), selectedDate.getMonth() + 1, 0);
    
    const url = `/analytics/report?start=${startDate.toISOString().split('T')[0]}&end=${endDate.toISOString().split('T')[0]}`;
    window.location.href = url;
}

function switchCalendarView(view) {
    // Changer la vue du calendrier
    if (window.calendar && typeof window.calendar.changeView === 'function') {
        window.calendar.changeView(view);
    }
    
    // Mettre à jour les boutons actifs
    document.querySelectorAll('.btn-group .btn').forEach(btn => {
        btn.classList.remove('active');
    });
    event.target.classList.add('active');
}

function toggleEventFilter(filterType) {
    // Basculer l'affichage des événements selon le type
    if (window.calendar && typeof window.calendar.getEvents === 'function') {
        const events = window.calendar.getEvents();
        const checkbox = document.getElementById(`filter${filterType.charAt(0).toUpperCase() + filterType.slice(1)}`);
        
        events.forEach(event => {
            if (event.extendedProps && event.extendedProps.type === filterType) {
                event.setProp('display', checkbox.checked ? 'auto' : 'none');
            }
        });
    }
}

// Initialisation des actions rapides du calendrier
document.addEventListener('DOMContentLoaded', function() {
    console.log('✅ Actions rapides du calendrier initialisées');
});
</script>
