<!-- Modal Simple pour Détails des Bons de Travail -->
<div class="modal fade" id="workOrderSimpleDetailsModal" tabindex="-1" aria-labelledby="workOrderSimpleDetailsModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="workOrderSimpleDetailsModalLabel">
                    <i class="fa-solid fa-file-lines me-2 text-primary"></i>Bon de Travail
                    <span id="simple-modal-work-order-number" class="badge bg-primary ms-2">#</span>
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <!-- Informations de base -->
                    <div class="col-md-6 mb-3">
                        <label class="form-label fw-bold">Client</label>
                        <p class="form-control-plaintext" id="simple-customer-name">-</p>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-label fw-bold">Statut</label>
                        <span id="simple-status-badge" class="badge bg-secondary">-</span>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-label fw-bold">Priorité</label>
                        <span id="simple-priority-badge" class="badge bg-info">-</span>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-label fw-bold">Technicien</label>
                        <p class="form-control-plaintext" id="simple-technician-name">-</p>
                    </div>
                    <div class="col-12 mb-3">
                        <label class="form-label fw-bold">Description</label>
                        <p class="form-control-plaintext" id="simple-description">-</p>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-label fw-bold">Date de création</label>
                        <p class="form-control-plaintext" id="simple-created-date">-</p>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-label fw-bold">Date prévue</label>
                        <p class="form-control-plaintext" id="simple-scheduled-date">-</p>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fermer</button>
                <button type="button" class="btn btn-primary" onclick="openFullDetailsModal()">
                    <i class="fa-solid fa-expand me-1"></i>Voir les détails complets
                </button>
            </div>
        </div>
    </div>
</div>

<script>
// Fonction pour ouvrir la modal simple avec les données
function openSimpleWorkOrderModal(workOrderData) {
    // Remplir les données
    document.getElementById('simple-modal-work-order-number').textContent = '#' + workOrderData.id;
    document.getElementById('simple-customer-name').textContent = workOrderData.customer_name || '-';
    document.getElementById('simple-technician-name').textContent = workOrderData.technician_name || 'Non assigné';
    document.getElementById('simple-description').textContent = workOrderData.description || '-';
    document.getElementById('simple-created-date').textContent = workOrderData.created_date || '-';
    document.getElementById('simple-scheduled-date').textContent = workOrderData.scheduled_date || '-';
    
    // Badges de statut
    const statusBadge = document.getElementById('simple-status-badge');
    statusBadge.textContent = workOrderData.status || '-';
    statusBadge.className = 'badge ' + getStatusBadgeClass(workOrderData.status);
    
    // Badge de priorité
    const priorityBadge = document.getElementById('simple-priority-badge');
    priorityBadge.textContent = workOrderData.priority || '-';
    priorityBadge.className = 'badge ' + getPriorityBadgeClass(workOrderData.priority);
    
    // Ouvrir la modal
    new bootstrap.Modal(document.getElementById('workOrderSimpleDetailsModal')).show();
}

// Fonction pour ouvrir les détails complets
function openFullDetailsModal() {
    // Fermer la modal simple
    bootstrap.Modal.getInstance(document.getElementById('workOrderSimpleDetailsModal')).hide();
    
    // Ouvrir la modal détaillée (si elle existe)
    const fullModal = document.getElementById('workOrderDetailsModal');
    if (fullModal) {
        new bootstrap.Modal(fullModal).show();
    }
}

// Fonctions utilitaires pour les badges
function getStatusBadgeClass(status) {
    const statusClasses = {
        'draft': 'bg-secondary',
        'pending': 'bg-warning',
        'assigned': 'bg-info',
        'in_progress': 'bg-primary',
        'completed': 'bg-success',
        'cancelled': 'bg-danger'
    };
    return statusClasses[status] || 'bg-secondary';
}

function getPriorityBadgeClass(priority) {
    const priorityClasses = {
        'low': 'bg-success',
        'medium': 'bg-warning',
        'high': 'bg-danger',
        'urgent': 'bg-danger'
    };
    return priorityClasses[priority] || 'bg-info';
}
</script>
